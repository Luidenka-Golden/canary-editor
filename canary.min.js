function newEditor(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");e.id="canary-editor",t.id="line-number",t.innerText="1",n.id="line-content",n.spellcheck=!1,n.contentEditable=!0,n.addEventListener("input",()=>{t.innerHTML="";let e=n.innerText.split("\n").length;if(1!=e){isNewLine=!0;for(let r=0;r<e;r++)0!=r&&(t.innerText+=r,t.innerText+="\n")}else t.innerText=1;let i=getCaretCharacterOffsetWithin(n);n.innerHTML=highlight(n.innerText,"cpp"),setCaret(n,i)}),n.addEventListener("keypress",e=>{var t=String.fromCharCode(e.which);if("{"==t||"("==t||"["==t||'"'==t||"'"==t){e.preventDefault();var n=window.getSelection();if(n.rangeCount>0){var r,i=n.getRangeAt(0);i.deleteContents(),r="{"==t?"{}":"["==t?"[]":'"'==t?'""':"'"==t?"''":"()";var a=document.createTextNode(r);i.insertNode(a),i.setStart(a,1),i.setEnd(a,1),n.removeAllRanges(),n.addRange(i)}}}),n.addEventListener("keydown",e=>{9==e.keyCode&&(e.preventDefault(),insertTab())}),n.addEventListener("scroll",()=>{t.scrollTop=n.scrollTop}),e.appendChild(t),e.appendChild(n),document.body.appendChild(e)}function newEditorWithElement(e){var t=document.getElementById(e),n=document.createElement("div"),r=document.createElement("div");n.id="line-number",n.innerText="1",r.id="line-content",r.spellcheck=!1,r.contentEditable=!0,r.addEventListener("input",()=>{n.innerHTML="";let e=r.innerText.split("\n").length;if(1!=e){isNewLine=!0;for(let t=0;t<e;t++)0!=t&&(n.innerText+=t,n.innerText+="\n")}else n.innerText=1;let i=getCaretCharacterOffsetWithin(r);r.innerHTML=highlight(r.innerText,"cpp"),setCaret(r,i)}),r.addEventListener("keypress",e=>{var t=String.fromCharCode(e.which);if("{"==t||"("==t||"["==t||'"'==t||"'"==t){e.preventDefault();var n=window.getSelection();if(n.rangeCount>0){var r,i=n.getRangeAt(0);i.deleteContents(),r="{"==t?"{}":"["==t?"[]":'"'==t?'""':"'"==t?"''":"()";var a=document.createTextNode(r);i.insertNode(a),i.setStart(a,1),i.setEnd(a,1),n.removeAllRanges(),n.addRange(i)}}}),r.addEventListener("keydown",e=>{9==e.keyCode&&(e.preventDefault(),insertTab())}),r.addEventListener("scroll",()=>{n.scrollTop=r.scrollTop}),t.appendChild(n),t.appendChild(r)}function insertTab(){if(!window.getSelection)return;let e=window.getSelection();if(!e.rangeCount)return;let t=e.getRangeAt(0);t.collapse(!0);let n=document.createElement("span");n.appendChild(document.createTextNode("    ")),n.style.whiteSpace="pre",t.insertNode(n),t.setStartAfter(n),t.collapse(!0),e.removeAllRanges(),e.addRange(t)}function getCaretCharacterOffsetWithin(e){var t,n=0,r=e.ownerDocument||e.document,i=r.defaultView||r.parentWindow;if(void 0!==i.getSelection){if((t=i.getSelection()).rangeCount>0){var a=i.getSelection().getRangeAt(0),l=a.cloneRange();l.selectNodeContents(e),l.setEnd(a.endContainer,a.endOffset),n=l.toString().length}}else if((t=r.selection)&&"Control"!=t.type){var o=t.createRange(),d=r.body.createTextRange();d.moveToElementText(e),d.setEndPoint("EndToEnd",o),n=d.text.length}return n}function encodeHTMLEntities(e){return e.replace(/[\u00A0-\u9999<>\&]/g,e=>`&#${e.charCodeAt(0)};`)}function setCaret(e,t){for(var n of e.childNodes)if(3==n.nodeType){if(n.length>=t){var r=document.createRange(),i=window.getSelection();return r.setStart(n,t),r.collapse(!0),i.removeAllRanges(),i.addRange(r),-1}t-=n.length}else if(-1==(t=setCaret(n,t)))return -1;return t}function highlight(e,t){let n=encodeHTMLEntities(e).split(/(\s+)/);if("cpp"==t){let r=n.map(e=>"int"===e||"char"===e||"bool"===e||"string"===e||"void"===e?`<span style="color: rgb(105, 182, 250);">${e}</span>`:"#include"===e||e.match("if")||e.match("return")||e.match("else")?`<span style='color: rgb(221, 172, 250);'>${e}</span>`:e.match(/".*"/)?`<span style="color: rgb(217, 168, 147)">${e}</span>`:e.match(/&#60;.*&#62;/)?`<span style="color: rgb(217, 168, 147)">${e}</span>`:e);return r.join("")}}